### Java 正则表达式系统总结

---

#### **一、核心类与基本用法**

Java 正则表达式通过 `java.util.regex` 包实现，主要涉及两个类：

1. **`Pattern` 类**
    - **作用**：编译正则表达式为可重用的模式对象。
    - **核心方法**：
      ```java
      Pattern pattern = Pattern.compile("正则表达式"); // 编译正则
      Matcher matcher = pattern.matcher("输入文本");    // 创建匹配器
      ```

2. **`Matcher` 类**
    - **作用**：执行匹配操作，提供查找、替换等功能。
    - **核心方法**：
      ```java
      boolean matches = matcher.matches();       // 全文本匹配
      boolean find = matcher.find();             // 查找下一个匹配项
      String group = matcher.group();            // 获取匹配内容
      ```

3. **`String` 类的便捷方法**
   ```java
   boolean isMatch = "text".matches("正则");     // 直接全匹配
   String[] parts = "a,b,c".split(",");         // 分割字符串
   String newStr = "abc".replaceAll("a", "x");  // 替换所有匹配项
   ```

---

#### **二、正则表达式语法详解**

##### **1. 元字符（Meta Characters）**

| 元字符  | 说明                    | 示例                |
|------|-----------------------|-------------------|
| `.`  | 匹配任意字符（除换行符）          | `a.c` → "abc"     |
| `\d` | 数字 (`[0-9]`)          | `\d{3}` → "123"   |
| `\D` | 非数字                   | `\D+` → "abc"     |
| `\w` | 单词字符 (`[a-zA-Z0-9_]`) | `\w+` → "user123" |
| `\W` | 非单词字符                 | `\W` → "@"        |
| `\s` | 空白字符（空格、制表符等）         | `\s+` → "  "      |
| `\S` | 非空白字符                 | `\S+` → "Hello"   |

##### **2. 量词（Quantifiers）**

| 量词      | 说明      | 示例                            |
|---------|---------|-------------------------------|
| `*`     | 0 或多次   | `a*` → "", "a", "aa"          |
| `+`     | 1 或多次   | `\d+` → "1", "123"            |
| `?`     | 0 或 1 次 | `colou?r` → "color", "colour" |
| `{n}`   | 精确 n 次  | `\d{4}` → "2023"              |
| `{n,}`  | 至少 n 次  | `\w{3,}` → "abc", "abcd"      |
| `{n,m}` | n 到 m 次 | `a{2,4}` → "aa", "aaa"        |

##### **3. 边界匹配**

| 符号   | 说明   | 示例                        |
|------|------|---------------------------|
| `^`  | 行首   | `^Java` → 匹配以 "Java" 开头的行 |
| `$`  | 行尾   | `end$` → 匹配以 "end" 结尾的行   |
| `\b` | 单词边界 | `\bcat\b` → 匹配独立的 "cat"   |

##### **4. 字符类（Character Classes）**

| 语法         | 说明           | 示例                             |
|------------|--------------|--------------------------------|
| `[abc]`    | 匹配 a、b 或 c   | `[aeiou]` → 匹配元音字母             |
| `[^abc]`   | 排除 a、b、c     | `[^0-9]` → 匹配非数字字符             |
| `[a-zA-Z]` | 范围匹配         | `[A-Za-z]+` → 匹配英文单词           |
| `(?i)`     | 忽略大小写（模式修饰符） | `(?i)java` → 匹配 "Java", "JAVA" |

##### **5. 分组与捕获**

| 语法            | 说明             | 示例                       |
|---------------|----------------|--------------------------|
| `(pattern)`   | 捕获分组           | `(\d{4})-(\d{2})` → 捕获年月 |
| `(?:pattern)` | 非捕获分组（不保存匹配结果） | `(?:\d{3})-` → 匹配但不捕获区号  |
| `\n`          | 反向引用第 n 个分组    | `(\d)\1` → 匹配 "11", "22" |

##### **6. 预搜索断言（Lookaround）**

| 语法             | 说明     | 示例                                        |
|----------------|--------|-------------------------------------------|
| `(?=pattern)`  | 正向肯定预查 | `Windows(?=10)` → 匹配后面跟 "10" 的 "Windows"  |
| `(?!pattern)`  | 正向否定预查 | `Java(?!Script)` → 匹配不跟 "Script" 的 "Java" |
| `(?<=pattern)` | 反向肯定预查 | `(?<=\$)\d+` → 匹配 "$100" 中的 "100"         |
| `(?<!pattern)` | 反向否定预查 | `(?<!\d)7` → 匹配前面不是数字的 "7"                |

---

#### **三、Java 正则表达式高级用法**

##### **1. 模式修饰符**

通过 `Pattern.compile(String regex, int flags)` 设置：

```java
Pattern.compile("regex",Pattern.CASE_INSENSITIVE |Pattern.MULTILINE);
```

| 修饰符                        | 说明                         |
|----------------------------|----------------------------|
| `Pattern.CASE_INSENSITIVE` | 忽略大小写                      |
| `Pattern.MULTILINE`        | 多行模式（`^` 和 `$` 匹配每行的开头和结尾） |
| `Pattern.DOTALL`           | `.` 匹配包括换行符的所有字符           |

##### **2. 命名分组（Java 7+）**

```java
Pattern pattern = Pattern.compile("(?<year>\\d{4})-(?<month>\\d{2})");
Matcher matcher = pattern.matcher("2023-07");
if(matcher.

find()){
String year = matcher.group("year");   // "2023"
String month = matcher.group("month"); // "07"
}
```

##### **3. 替换操作**

```java
// 简单替换
String result = "a1b2c3".replaceAll("\\d", "X"); // "aXbXcX"

// 使用回调函数动态替换
Pattern pattern = Pattern.compile("\\d+");
Matcher matcher = pattern.matcher("a1b22c333");
String result = matcher.replaceAll(match -> {
    int num = Integer.parseInt(match.group());
    return String.valueOf(num * 2); // "a2b44c666"
});
```

---

#### **四、常见使用场景与示例**

##### **1. 数据验证**

```java
// 验证邮箱
boolean isValidEmail = "user@example.com".matches("\\w+@\\w+\\.\\w+");

// 验证手机号（中国）
String regex = "^1[3-9]\\d{9}$";
boolean isValidPhone = "13812345678".matches(regex);
```

##### **2. 数据提取**

```java
String log = "IP:192.168.1.1, Time:2023-07-22";
Pattern ipPattern = Pattern.compile("\\b(?:\\d{1,3}\\.){3}\\d{1,3}\\b");
Matcher matcher = ipPattern.matcher(log);
if(matcher.

find()){
String ip = matcher.group(); // "192.168.1.1"
}
```

##### **3. 文本清洗**

```java
// 去除HTML标签
String html = "<div>Hello <b>World</b></div>";
String cleanText = html.replaceAll("<[^>]+>", ""); // "Hello World"
```

##### **4. 复杂分割**

```java
String csv = "a, \"b,c\", d";
// 分割逗号（忽略引号内的逗号）
String[] parts = csv.split(",(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)");
// ["a", " \"b,c\"", " d"]
```

---

#### **五、性能优化与陷阱**

##### **1. 预编译正则表达式**

```java
// 避免重复编译
private static final Pattern DATE_PATTERN = Pattern.compile("\\d{4}-\\d{2}-\\d{2}");
```

##### **2. 避免贪婪量词**

```java
// 贪婪模式（可能匹配过多）
String greedy = "<div>.*</div>";

// 懒惰模式（更精确）
String lazy = "<div>.*?</div>"; 
```

##### **3. 防止回溯灾难**

```java
// 危险的正则（嵌套量词导致性能问题）
String badRegex = "(a+)+";

// 优化后
String safeRegex = "a+"; 
```

---

#### **六、工具推荐**

1. **在线测试工具**：
    - [Regex101](https://regex101.com/)（支持Java语法）
    - [RegExr](https://regexr.com/)
2. **IDE 插件**：
    - IntelliJ IDEA 内置正则检查器
    - VS Code 的 Regex Previewer

---

#### **七、总结**

| **核心要点** | **关键点**                       |
|----------|-------------------------------|
| **核心类**  | `Pattern` 编译正则，`Matcher` 执行匹配 |
| **语法核心** | 元字符、量词、分组、预搜索断言               |
| **性能优化** | 预编译正则、避免贪婪匹配、减少回溯             |
| **实际应用** | 验证、提取、替换、分割                   |

通过系统掌握这些知识，可以高效处理文本匹配、数据验证等复杂场景。